<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\projects\chatle\test\chatle.test\Controllers\HomeControllerTest.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using ChatLe.Controllers;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.ModelBinding;
using Microsoft.AspNetCore.Mvc.ViewFeatures;
using Microsoft.Extensions.Logging;
using Moq;
using System;
using System.Security.Claims;
using System.Security.Principal;
using Xunit;

namespace chatle.test.Controllers
{
    public class HomeControllerTest
    {
		[Fact]
		public void IndexTest()
		{
			ExecuteAction(controller =&gt;
			{
				var mockHttpContext = new Mock&lt;HttpContext&gt;();
				var mockClaims = new Mock&lt;ClaimsPrincipal&gt;();
				var mockIndentity = new Mock&lt;IIdentity&gt;();
				mockIndentity.SetupGet(i =&gt; i.IsAuthenticated).Returns(true);
				mockClaims.SetupGet(c =&gt; c.Identity).Returns(mockIndentity.Object);
				mockHttpContext.SetupGet(h =&gt; h.User).Returns(mockClaims.Object);
				controller.ControllerContext.HttpContext = mockHttpContext.Object;

				var result = controller.Index();
				Assert.IsType&lt;ViewResult&gt;(result);

				mockIndentity.SetupGet(i =&gt; i.IsAuthenticated).Returns(false);
				result = controller.Index();
				Assert.IsType&lt;RedirectToRouteResult&gt;(result);
			});
		}

        internal static void ExecuteAction(Action&lt;HomeController&gt; a)
		{
			var mockLoggerFactory = new Mock&lt;ILoggerFactory&gt;();
			mockLoggerFactory.Setup(f =&gt; f.CreateLogger(It.IsAny&lt;string&gt;())).Returns(new Mock&lt;ILogger&gt;().Object);
			var viewData = new ViewDataDictionary(new EmptyModelMetadataProvider(), new ModelStateDictionary());
			var controller = new HomeController(mockLoggerFactory.Object) { ViewData = viewData };
			using (controller)
			{
				a.Invoke(controller);
			}
		}

		[Fact]
		public void AboutTest()
		{
			ExecuteAction(controller =&gt;
			{
				var result = controller.About();
				Assert.IsType&lt;ViewResult&gt;(result);
			});
		}

		[Fact]
		public void ContactTest()
		{
			ExecuteAction(controller =&gt;
			{
				var result = controller.Contact();
				Assert.IsType&lt;ViewResult&gt;(result);
			});
		}

		[Fact]
		public void ErrorTest()
		{
			ExecuteAction(controller =&gt;
			{
				var mockHttpContext = new Mock&lt;HttpContext&gt;();
				var mockFeatures = new Mock&lt;IFeatureCollection&gt;();
				mockHttpContext.SetupGet(h =&gt; h.Features).Returns(mockFeatures.Object);
				controller.ControllerContext.HttpContext = mockHttpContext.Object;

				var result = controller.Error();
				Assert.IsType&lt;ViewResult&gt;(result);
			});
		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[20,3,20,4,1],[21,4,22,4,1],[22,4,22,5,1],[22,5,23,5,1],[23,5,23,51,1],[23,51,24,5,1],[24,5,24,50,1],[24,50,25,5,1],[25,5,25,47,1],[25,47,26,5,1],[26,5,26,66,1],[26,66,27,5,1],[27,5,27,72,1],[27,72,28,5,1],[28,5,28,70,1],[28,70,29,5,1],[29,5,29,71,1],[29,71,31,5,1],[31,5,31,37,1],[31,37,32,5,1],[32,5,32,39,1],[32,39,34,5,1],[34,5,34,67,1],[34,67,35,5,1],[35,5,35,33,1],[35,33,36,5,1],[36,5,36,50,1],[36,50,37,4,1],[37,4,37,5,1],[37,5,37,7,1],[21,4,37,7,1],[38,3,38,4,1],[41,3,41,4,1],[42,4,42,55,1],[43,4,43,105,1],[44,4,44,104,1],[45,4,45,90,1],[46,4,46,22,1],[47,4,47,5,1],[48,5,48,26,1],[49,4,49,5,1],[50,3,50,4,1],[54,3,54,4,1],[55,4,56,4,1],[56,4,56,5,1],[56,5,57,5,1],[57,5,57,37,1],[57,37,58,5,1],[58,5,58,39,1],[58,39,59,4,1],[59,4,59,5,1],[59,5,59,7,1],[55,4,59,7,1],[60,3,60,4,1],[64,3,64,4,1],[65,4,66,4,1],[66,4,66,5,1],[66,5,67,5,1],[67,5,67,39,1],[67,39,68,5,1],[68,5,68,39,1],[68,39,69,4,1],[69,4,69,5,1],[69,5,69,7,1],[65,4,69,7,1],[70,3,70,4,1],[74,3,74,4,1],[75,4,76,4,1],[76,4,76,5,1],[76,5,77,5,1],[77,5,77,51,1],[77,51,78,5,1],[78,5,78,55,1],[78,55,79,5,1],[79,5,79,76,1],[79,76,80,5,1],[80,5,80,71,1],[80,71,82,5,1],[82,5,82,37,1],[82,37,83,5,1],[83,5,83,39,1],[83,39,84,4,1],[84,4,84,5,1],[84,5,84,7,1],[75,4,84,7,1],[85,3,85,4,1]]);
    </script>
  </body>
</html>